[defaults]
# Path to the inventory file (will be dynamically created or passed as localhost)
inventory = /dev/null

# Use the AWS SSM connection plugin for instances.
# This eliminates the need for SSH keys or open SSH ports.
remote_user = ubuntu
transport = community.aws.aws_ssm

# Disable creating .retry files, which can clutter the filesystem
retry_files_enabled = False

# Host key checking is not applicable for SSM connections.
host_key_checking = False

# Enable human-readable playbook logging
stdout_callback = yaml

# Enable detailed logging to a file (your suggestion)
log_path = /var/log/ansible_playbook.log

# Log detail level
verbosity = 2

# Timeout in seconds
timeout = 60

[ssh_connection]
# Disable control path for SSM connections to prevent issues
# with concurrent sessions and ensure clean session termination.
control_path = %(directory)s/%%h-%%p-%%r
# Do not attempt to use SSH for connection type community.aws.aws_ssm
ssh_args = -o ControlMaster=no -o ControlPersist=no -o PreferredAuthentications=publickey
